{% extends "base.html" %}
{% block title %}HeatMap{% endblock %}
{%block head%}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/heatmap.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>
<style>
#HeatMap {
    min-width: 300px;
    max-width: 800px;
    height: 400px;
    margin: 1em auto;
}
</style>
{% endblock %}

{% block content %}
<div class='container'>
  <div id="HeatMap"></div>
</div>

<script>
var sTTime = [{% for start_time in startTimeList %}'{{start_time}}'{% if not loop.last %},{% endif %}{% endfor %}]

var intersection_name = [{% for inter in Corridor_intersection[0] %}'{{inter}}'{% if not loop.last %},{% endif %}{% endfor %}]

var data_heatmap = [{% for data in result %}[{{data[0]}},{{data[1]}},{{data[2]}}]{% if not loop.last %},{% endif %}{% endfor %}]

$('#HeatMap').highcharts({
  chart: {
    type: 'heatmap',
    marginTop: 40,
    marginBottom: 40
  },


  title: {
    text: 'Heat Map'
  },
  xAxis: {
    categories: sTTime
  },

  yAxis: {
    categories: intersection_name,
    title: null
  },

  colorAxis: {
    min: -5,
    max: 5,
    minColor: '#FFFFFF',
    maxColor: Highcharts.getOptions().colors[0]
  },

  legend: {
    align: 'right',
    layout: 'vertical',
    margin: 0,
    verticalAlign: 'top',
    y: 25,
    symbolHeight: 320
  },

  // tooltip: {
  //   formatter: function () {
  //     return '<b>' + this.series.xAxis.categories[this.point.x] + '</b> sold <br><b>' +
  //     this.point.value + '</b> items on <br><b>' + this.series.yAxis.categories[this.point.y] + '</b>';
  //   }
  // },

  series: [{
    name: 'Easiness to Travel',
    borderWidth: 1,
    data: data_heatmap,
    dataLabels: {
      enabled: false,
      color: 'black',
      style: {
        textShadow: 'none'
      }
    }
  }]
});
</script>
{% endblock %}
